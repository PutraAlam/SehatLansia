<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>SehatLansia - Gaya Hidup Sehat & Bahagia</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    <style>
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background-color: #f8fafc;
            color: #334155;
            font-size: 18px;
            overflow-x: hidden;
        }

        .hero-section {
            background: linear-gradient(rgba(30, 64, 175, 0.7), rgba(30, 64, 175, 0.7)), url('https://images.unsplash.com/photo-1571019614248-c5c7c354dc48?ixlib=rb-1.2.1&auto=format&fit=crop&w=1950&q=80');
            background-size: cover;
            background-position: center;
            height: 80vh;
            min-height: 600px;
            display: flex;
            align-items: center;
            justify-content: center;
            text-align: center;
            color: white;
            position: relative;
        }

        .card-hover {
            transition: transform 0.3s ease, box-shadow 0.3s ease;
        }
        .card-hover:hover {
            transform: translateY(-10px);
            box-shadow: 0 20px 25px -5px rgba(0, 0, 0, 0.1), 0 10px 10px -5px rgba(0, 0, 0, 0.04);
        }

        .btn-action {
            padding: 12px 30px;
            border-radius: 50px;
            font-weight: bold;
            font-size: 1.1rem;
            transition: all 0.3s;
        }
        .btn-action:active { transform: scale(0.95); }

        html { scroll-behavior: smooth; }
        
        .modal-article {
            animation: fadeIn 0.3s ease-out;
        }
        
        .fade-in-section {
            opacity: 0;
            transform: translateY(50px);
            transition: opacity 0.8s ease, transform 0.8s ease;
        }
        
        .fade-in-section.is-visible {
            opacity: 1;
            transform: translateY(0);
        }
        
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }
        
        .reply-item {
            border-left: 3px solid #e5e7eb;
            margin-left: 2rem;
            padding-left: 1.5rem;
            background-color: #f9fafb;
        }
        
        .highlight-new {
            animation: highlightPulse 2s ease-in-out;
        }
        
        @keyframes highlightPulse {
            0% { background-color: transparent; }
            50% { background-color: rgba(255, 251, 235, 0.8); }
            100% { background-color: transparent; }
        }

        /* Style untuk tabel artikel */
        .article-table {
            width: 100%;
            border-collapse: collapse;
            margin: 1.5rem 0;
            font-size: 0.95rem;
        }
        .article-table th {
            background-color: #f3f4f6;
            font-weight: bold;
            padding: 12px;
            border: 1px solid #e5e7eb;
            text-align: left;
        }
        .article-table td {
            padding: 12px;
            border: 1px solid #e5e7eb;
            vertical-align: top;
        }
        .article-table tr:nth-child(even) {
            background-color: #f9fafb;
        }
    </style>
</head>
<body>

    <nav class="bg-white/95 backdrop-blur-sm fixed w-full z-50 shadow-md transition-all duration-300">
        <div class="container mx-auto px-6 py-4 flex justify-between items-center">
            <div class="flex items-center gap-2 cursor-pointer" onclick="window.scrollTo(0,0)">
                <i class="fas fa-heartbeat text-3xl text-blue-800"></i>
                <div>
                    <h1 class="text-2xl font-bold text-blue-900 leading-none">SehatLansia</h1>
                    <p class="text-xs text-blue-600 font-semibold tracking-wider">PENDAMPING TERPERCAYA</p>
                </div>
            </div>
            
            <div class="hidden md:block">
                <button onclick="window.location.href='#forum'" class="bg-blue-600 text-white px-6 py-2 rounded-full font-bold shadow hover:bg-blue-700 transition">
                    <i class="fas fa-comments mr-2"></i>Forum Diskusi
                </button>
            </div>
            
            <button class="md:hidden text-blue-900 text-2xl" onclick="toggleMobileMenu()">
                <i class="fas fa-bars"></i>
            </button>
            
            <!-- Mobile Menu -->
            <div id="mobileMenu" class="hidden md:hidden absolute top-full left-0 right-0 bg-white shadow-lg">
                <div class="p-4">
                    <button onclick="window.location.href='#forum'" class="w-full bg-blue-600 text-white px-6 py-3 rounded-full font-bold shadow mb-2">
                        <i class="fas fa-comments mr-2"></i>Forum Diskusi
                    </button>
                </div>
            </div>
        </div>
    </nav>

    <header class="hero-section">
        <div class="container mx-auto px-6 fade-in">
            <h2 class="text-4xl md:text-6xl font-bold mb-6 text-yellow-300 drop-shadow-md">
                Nikmati Masa Emas <br> Dengan Tubuh Sehat
            </h2>
            <p class="text-xl md:text-2xl mb-10 max-w-2xl mx-auto text-blue-50 font-light">
                Panduan kesehatan lengkap, tips nutrisi, dan komunitas peduli untuk lansia dan keluarga.
            </p>
            <a href="#featured" class="btn-action bg-yellow-400 text-blue-900 hover:bg-yellow-300 shadow-lg inline-block">
                Mulai Membaca <i class="fas fa-arrow-down ml-2"></i>
            </a>
        </div>
    </header>

    <main class="container mx-auto px-6 py-16 -mt-20 relative z-10">
        
        <!-- Bagian "Apa itu Stroke?" yang ditambahkan -->
        <section id="tentang-stroke" class="mb-16 fade-in-section">
            <div class="bg-white p-8 rounded-2xl shadow-lg border border-gray-100">
                <div class="section-title text-center mb-8">
                    <h2 class="text-3xl font-bold text-blue-900 mb-2">Apa itu Stroke?</h2>
                    <p class="text-gray-600 max-w-3xl mx-auto">Stroke adalah penyakit yang terjadi ketika aliran darah ke otak terganggu atau terhenti, sehingga sel-sel otak kekurangan oksigen dan nutrisi. Kondisi ini dapat disebabkan oleh penyumbatan pembuluh darah (stroke iskemik) atau pecahnya pembuluh darah di otak (stroke hemoragik), yang dapat mengakibatkan gangguan gerak, bicara, hingga kesadaran dan memerlukan penanganan medis segera.</p>
                </div>
                <!-- Jika diperlukan konten tambahan, bisa ditambahkan di sini -->
            </div>
        </section>
        
        <div id="featured" class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-8 mb-16">
            <div class="bg-white rounded-2xl shadow-xl overflow-hidden card-hover border-b-4 border-red-500 fade-in-section">
                <div class="h-48 bg-red-100 flex items-center justify-center">
                    <i class="fas fa-heart text-6xl text-red-500"></i>
                </div>
                <div class="p-6">
                    <h3 class="text-xl font-bold text-gray-800 mb-2">Cara Memandikan</h3>
                    <p class="text-gray-600 text-base mb-4">Panduan memandikan pasien stroke dengan aman dan nyaman.</p>
                    <button class="text-red-600 font-bold hover:underline" onclick="showArticle('jantung')">Baca Selengkapnya &rarr;</button>
                </div>
            </div>

            <div class="bg-white rounded-2xl shadow-xl overflow-hidden card-hover border-b-4 border-green-500 fade-in-section">
                <div class="h-48 bg-green-100 flex items-center justify-center">
                    <i class="fas fa-carrot text-6xl text-green-500"></i>
                </div>
                <div class="p-6">
                    <h3 class="text-xl font-bold text-gray-800 mb-2">Cara Menyuapi</h3>
                    <p class="text-gray-600 text-base mb-4">Panduan makanan yang mudah dicerna dan kaya vitamin.</p>
                    <button class="text-green-600 font-bold hover:underline" onclick="showArticle('nutrisi')">Baca Selengkapnya &rarr;</button>
                </div>
            </div>

            <div class="bg-white rounded-2xl shadow-xl overflow-hidden card-hover border-b-4 border-blue-500 fade-in-section">
                <div class="h-48 bg-blue-100 flex items-center justify-center">
                    <i class="fas fa-bone text-6xl text-blue-500"></i>
                </div>
                <div class="p-6">
                    <h3 class="text-xl font-bold text-gray-800 mb-2">Berjemur</h3>
                    <p class="text-gray-600 text-base mb-4">Tata cara berjemur yang aman untuk penyintas stroke.</p>
                    <button class="text-blue-600 font-bold hover:underline" onclick="showArticle('tulang')">Baca Selengkapnya &rarr;</button>
                </div>
            </div>

            <div class="bg-white rounded-2xl shadow-xl overflow-hidden card-hover border-b-4 border-purple-500 fade-in-section">
                <div class="h-48 bg-purple-100 flex items-center justify-center">
                    <i class="fas fa-brain text-6xl text-purple-500"></i>
                </div>
                <div class="p-6">
                    <h3 class="text-xl font-bold text-gray-800 mb-2">Fisioterapi</h3>
                    <p class="text-gray-600 text-base mb-4">Panduan lengkap fisioterapi pasca stroke.</p>
                    <button class="text-purple-600 font-bold hover:underline" onclick="showArticle('otak')">Baca Selengkapnya &rarr;</button>
                </div>
            </div>
        </div>

        <section class="bg-white p-8 rounded-2xl shadow-lg border border-gray-100 mb-16 fade-in-section">
            <div class="text-center mb-8">
                <h3 class="text-3xl font-bold text-blue-900 mb-2">ğŸ” Cari Informasi Kesehatan</h3>
                <p class="text-gray-500">Ketik keluhan atau topik (Misal: Diabetes, Asam Urat)</p>
            </div>
            
            <div class="flex flex-col md:flex-row gap-4 max-w-3xl mx-auto">
                <input type="text" id="searchInput" class="flex-1 p-4 rounded-xl border-2 border-blue-100 focus:border-yellow-400 focus:outline-none text-lg shadow-inner" placeholder="Pencarian...">
                <button onclick="handleSearch()" class="btn-action bg-blue-800 text-white hover:bg-blue-900 shadow-md">
                    Cari Artikel
                </button>
            </div>
            
            <div id="searchResultArea" class="mt-8 hidden">
                <h4 class="font-bold text-lg text-gray-700 border-b pb-2 mb-4">Hasil Pencarian:</h4>
                <div id="articlesList" class="space-y-4"></div>
            </div>
        </section>

        <!-- Bagian Diskusi Komunitas -->
        <section id="forum" class="grid md:grid-cols-3 gap-8 fade-in-section">
            <div class="md:col-span-1 bg-gradient-to-br from-blue-900 to-blue-800 text-white p-8 rounded-2xl shadow-xl h-fit sticky top-24">
                <h3 class="text-2xl font-bold mb-4"><i class="fas fa-comments mr-2"></i>Forum Diskusi</h3>
                <p class="mb-6 text-blue-100 text-sm">Bagikan pengalaman, ajukan pertanyaan, atau bantu jawab pertanyaan anggota lain.</p>
                
                <!-- Form diskusi tanpa login -->
                <div class="space-y-4">
                    <div>
                        <label class="block text-sm font-medium mb-2">Nama Anda</label>
                        <input type="text" id="userName" class="w-full p-3 rounded-lg text-gray-800" placeholder="Masukkan nama (opsional)" maxlength="30">
                        <p class="text-xs text-blue-200 mt-1">Jika kosong, akan tampil sebagai "Tamu"</p>
                    </div>
                    <div>
                        <label class="block text-sm font-medium mb-2">Topik Diskusi</label>
                        <input type="text" id="discussionTopic" class="w-full p-3 rounded-lg text-gray-800 mb-3" placeholder="Judul diskusi..." required>
                    </div>
                    <textarea id="commentInput" rows="4" class="w-full p-4 rounded-lg text-gray-800 text-lg mb-4 focus:ring-4 ring-yellow-400 outline-none" placeholder="Tulis isi diskusi Anda..." required></textarea>
                    <button onclick="addDiscussion()" class="w-full btn-action bg-yellow-400 text-blue-900 hover:bg-yellow-300">
                        <i class="fas fa-paper-plane mr-2"></i>Mulai Diskusi
                    </button>
                </div>
                
                <div class="mt-8 pt-6 border-t border-blue-700">
                    <h4 class="font-bold mb-3">ğŸ“Š Statistik Forum</h4>
                    <div class="grid grid-cols-2 gap-3">
                        <div class="bg-blue-800/50 p-3 rounded-lg text-center">
                            <p class="text-2xl font-bold" id="totalDiscussions">0</p>
                            <p class="text-xs text-blue-200">Diskusi</p>
                        </div>
                        <div class="bg-blue-800/50 p-3 rounded-lg text-center">
                            <p class="text-2xl font-bold" id="totalReplies">0</p>
                            <p class="text-xs text-blue-200">Balasan</p>
                        </div>
                    </div>
                </div>
                
                <div class="mt-6 p-4 bg-blue-800/30 rounded-lg">
                    <h4 class="font-bold mb-2">ğŸ’¡ Tips Forum:</h4>
                    <ul class="text-xs space-y-1 text-blue-100">
                        <li>â€¢ Gunakan bahasa yang sopan dan santun</li>
                        <li>â€¢ Jangan bagikan informasi pribadi</li>
                        <li>â€¢ Fokus pada topik kesehatan lansia</li>
                        <li>â€¢ Hormati pendapat orang lain</li>
                    </ul>
                </div>
            </div>

            <!-- Daftar Diskusi -->
            <div class="md:col-span-2">
                <div class="flex items-center justify-between mb-6">
                    <h3 class="text-2xl font-bold text-gray-800">Diskusi Terbaru</h3>
                    <div class="flex gap-2">
                        <button id="sortNewest" class="bg-blue-100 text-blue-700 px-3 py-1 rounded-full text-sm font-bold hover:bg-blue-200" onclick="sortDiscussions('newest')">
                            <i class="fas fa-clock mr-1"></i>Terbaru
                        </button>
                        <button id="sortPopular" class="bg-gray-100 text-gray-700 px-3 py-1 rounded-full text-sm font-bold hover:bg-gray-200" onclick="sortDiscussions('popular')">
                            <i class="fas fa-fire mr-1"></i>Populer
                        </button>
                    </div>
                </div>
                
                <div id="discussionsList" class="space-y-6">
                    <!-- Diskusi akan dimuat di sini -->
                </div>
                
                <div id="noDiscussions" class="text-center py-12 bg-gray-50 rounded-xl border border-dashed border-gray-300 hidden">
                    <i class="fas fa-comments text-4xl text-gray-400 mb-4"></i>
                    <h4 class="text-xl font-bold text-gray-600 mb-2">Belum ada diskusi</h4>
                    <p class="text-gray-500">Jadilah yang pertama memulai diskusi!</p>
                </div>
            </div>
        </section>

    </main>

    <footer class="bg-gray-800 text-gray-300 py-10 mt-12 border-t-8 border-yellow-400">
        <div class="container mx-auto px-6 text-center">
            <h2 class="text-2xl font-bold text-white mb-4">SehatLansia</h2>
            <p class="mb-6 max-w-lg mx-auto">Kami berdedikasi untuk memberikan informasi kesehatan yang akurat dan mudah dipahami demi kualitas hidup lansia yang lebih baik.</p>
            <div class="flex justify-center gap-6 mb-8">
                <button onclick="shareOnFacebook()" class="text-2xl hover:text-yellow-400"><i class="fab fa-facebook"></i></button>
                <button onclick="shareOnWhatsApp()" class="text-2xl hover:text-yellow-400"><i class="fab fa-whatsapp"></i></button>
                <button onclick="shareOnInstagram()" class="text-2xl hover:text-yellow-400"><i class="fab fa-instagram"></i></button>
            </div>
            <p class="text-sm">&copy; 2024 SehatLansia. All rights reserved.</p>
            <p class="text-xs text-gray-500 mt-4">Aplikasi ini berjalan 100% di browser Anda tanpa server</p>
        </div>
    </footer>

    <!-- Modal Artikel -->
    <div id="articleModal" class="fixed inset-0 bg-black/80 hidden z-[60] flex items-center justify-center p-4 backdrop-blur-sm">
        <div class="bg-white rounded-2xl max-w-4xl w-full max-h-[90vh] overflow-hidden shadow-2xl relative modal-article">
            <button onclick="closeModal('articleModal')" class="absolute top-4 right-4 text-gray-400 hover:text-red-500 text-2xl z-10 bg-white/80 rounded-full w-10 h-10 flex items-center justify-center">&times;</button>
            
            <div class="p-8 overflow-y-auto max-h-[85vh]">
                <div class="flex items-center gap-3 mb-6">
                    <div id="articleIcon" class="text-4xl"></div>
                    <div>
                        <h2 id="articleTitle" class="text-3xl font-bold text-gray-800"></h2>
                        <p id="articleSubtitle" class="text-gray-600"></p>
                    </div>
                </div>
                
                <div id="articleContent" class="prose prose-lg max-w-none text-gray-700">
                    <!-- Konten artikel akan dimuat di sini -->
                </div>
                
                <div class="mt-8 pt-6 border-t border-gray-200">
                    <h4 class="font-bold text-gray-800 mb-3">Bagikan artikel ini:</h4>
                    <div class="flex gap-3">
                        <button onclick="shareArticleOnFacebook()" class="bg-blue-100 text-blue-700 p-3 rounded-lg hover:bg-blue-200 transition">
                            <i class="fab fa-facebook"></i>
                        </button>
                        <button onclick="shareArticleOnWhatsApp()" class="bg-green-100 text-green-700 p-3 rounded-lg hover:bg-green-200 transition">
                            <i class="fab fa-whatsapp"></i>
                        </button>
                        <button onclick="shareArticleOnInstagram()" class="bg-pink-100 text-pink-700 p-3 rounded-lg hover:bg-pink-200 transition">
                            <i class="fab fa-instagram"></i>
                        </button>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Modal Balas Diskusi -->
    <div id="replyModal" class="fixed inset-0 bg-black/80 hidden z-[70] flex items-center justify-center p-4 backdrop-blur-sm">
        <div class="bg-white rounded-2xl max-w-2xl w-full overflow-hidden shadow-2xl relative modal-article">
            <button onclick="closeModal('replyModal')" class="absolute top-4 right-4 text-gray-400 hover:text-red-500 text-2xl z-10 bg-white/80 rounded-full w-10 h-10 flex items-center justify-center">&times;</button>
            
            <div class="p-8">
                <h3 class="text-2xl font-bold text-gray-800 mb-2" id="replyTitle">Balas Diskusi</h3>
                <p class="text-gray-600 mb-6" id="replyToQuestion"></p>
                
                <div class="mb-4">
                    <label class="block text-sm font-medium text-gray-700 mb-2">Nama Anda</label>
                    <input type="text" id="replyUserName" class="w-full p-3 rounded-lg border border-gray-300" placeholder="Masukkan nama (opsional)" maxlength="30">
                    <p class="text-xs text-gray-500 mt-1">Jika kosong, akan tampil sebagai "Tamu"</p>
                </div>
                
                <textarea id="replyInput" rows="6" class="w-full p-4 rounded-xl border-2 border-gray-200 focus:border-blue-500 focus:outline-none text-lg mb-6" placeholder="Tulis balasan Anda..." required></textarea>
                
                <div class="flex justify-end gap-3">
                    <button onclick="closeModal('replyModal')" class="px-6 py-2 border border-gray-300 rounded-lg font-bold text-gray-700 hover:bg-gray-100">
                        Batal
                    </button>
                    <button onclick="submitReply()" class="px-6 py-2 bg-blue-600 text-white rounded-lg font-bold hover:bg-blue-700">
                        Kirim Balasan
                    </button>
                </div>
            </div>
        </div>
    </div>

    <script>
        // --- DATA ARTIKEL LENGKAP ---
        const articlesDB = {
            jantung: {
                title: "Cara Memandikan",
                subtitle: "Panduan memandikan pasien stroke dengan aman",
                icon: '<i class="fas fa-heart text-red-500"></i>',
                content: `
                    <div class="space-y-6">
                        <p>Berikut cara memandikan orang yang mengalami stroke dengan aman dan nyaman. Pelan-pelan ya, yang penting keselamatan dan martabat pasien tetap terjaga.</p>
                        
                        <h3 class="text-2xl font-bold text-gray-800">Persiapan dulu</h3>
                        <ul class="list-disc pl-6 space-y-2">
                            <li>Alat lengkap: air hangat, sabun lembut, sampo, handuk besar, baju ganti, alas anti-licin.</li>
                            <li>Pastikan ruangan hangat supaya pasien tidak kedinginan.</li>
                            <li>Cek kondisi pasien: kalau terlihat sangat lelah, pusing, atau tekanan darah tidak stabil, sebaiknya ditunda.</li>
                        </ul>
                        
                        <h3 class="text-2xl font-bold text-gray-800">Posisi mandi (pilih sesuai kondisi)</h3>
                        <h4 class="text-xl font-bold text-gray-700">Di kamar mandi</h4>
                        <ul class="list-disc pl-6 space-y-2">
                            <li>Gunakan kursi mandi atau bangku.</li>
                            <li>Pasang alas anti-selip.</li>
                        </ul>
                        <h4 class="text-xl font-bold text-gray-700">Di tempat tidur (untuk yang tidak bisa berdiri/duduk lama)</h4>
                        <ul class="list-disc pl-6 space-y-2">
                            <li>Gunakan baskom dan waslap.</li>
                            <li>Tutupi bagian tubuh yang belum dimandikan dengan handuk.</li>
                        </ul>
                        
                        <h3 class="text-2xl font-bold text-gray-800">Langkah memandikan</h3>
                        <ol class="list-decimal pl-6 space-y-2">
                            <li>Mulai dari kepala ke bawah (rambut â†’ wajah â†’ badan â†’ kaki).</li>
                            <li>Bersihkan sisi tubuh yang lemah terakhir, lakukan perlahan.</li>
                            <li>Gunakan gerakan lembut, jangan ditarik atau dipaksa.</li>
                            <li>Bilas sampai bersih, jangan sampai sabun tertinggal (bisa bikin iritasi).</li>
                            <li>Keringkan dengan ditepuk pelan, terutama lipatan kulit.</li>
                            <li>Pakaikan baju bersih, utamakan sisi tubuh yang lemah dulu saat memakaikan.</li>
                        </ol>
                        
                        <h3 class="text-2xl font-bold text-gray-800">Hal penting yang harus diperhatikan</h3>
                        <ul class="list-disc pl-6 space-y-2">
                            <li>Jangan ditinggal sendirian di kamar mandi.</li>
                            <li>Komunikasi terus: beri tahu setiap langkah (â€œsekarang mau bilas yaâ€).</li>
                            <li>Perhatikan tanda tidak nyaman: napas cepat, pucat, gemetar â†’ hentikan dulu.</li>
                            <li>Kalau ada selang, luka, atau alat medis, hati-hati jangan sampai basah/tertarik.</li>
                        </ul>
                        
                        <h3 class="text-2xl font-bold text-gray-800">Tips tambahan</h3>
                        <ul class="list-disc pl-6 space-y-2">
                            <li>Mandikan di waktu pasien paling segar (biasanya pagi).</li>
                            <li>Gunakan sabun bayi atau sabun khusus kulit sensitif.</li>
                            <li>Jika memungkinkan, dua orang lebih aman, satu membantu menopang.</li>
                        </ul>
                    </div>
                `
            },
            nutrisi: {
                title: "Cara Menyuapi",
                subtitle: "Panduan makanan sehat dan bergizi",
                icon: '<i class="fas fa-carrot text-green-500"></i>',
                content: `
                    <div class="space-y-6">
                        <h3 class="text-2xl font-bold text-gray-800">ğŸ¥¦ Prinsip Gizi Lansia</h3>
                        <p>Kebutuhan nutrisi lansia berbeda dengan usia muda. Metabolisme melambat, tetapi kebutuhan vitamin dan mineral tetap tinggi.</p>
                        
                        <div class="grid md:grid-cols-2 gap-4 mt-6">
                            <div class="bg-green-50 p-4 rounded-lg">
                                <h4 class="font-bold text-green-700">âœ… Makanan Dianjurkan</h4>
                                <ul class="mt-2 space-y-2">
                                    <li>â€¢ Protein: Ikan, telur, tahu, tempe</li>
                                    <li>â€¢ Serat: Sayuran hijau, buah-buahan</li>
                                    <li>â€¢ Kalsium: Susu rendah lemak, yoghurt</li>
                                    <li>â€¢ Vitamin: Buah berwarna, sayuran</li>
                                </ul>
                            </div>
                            
                            <div class="bg-red-50 p-4 rounded-lg">
                                <h4 class="font-bold text-red-700">âŒ Makanan Dibatasi</h4>
                                <ul class="mt-2 space-y-2">
                                    <li>â€¢ Makanan tinggi garam</li>
                                    <li>â€¢ Makanan berminyak</li>
                                    <li>â€¢ Makanan manis berlebihan</li>
                                    <li>â€¢ Makanan kaleng/awetan</li>
                                </ul>
                            </div>
                        </div>
                        
                        <h3 class="text-2xl font-bold text-gray-800 mt-6">ğŸ½ï¸ Contoh Menu Sehari:</h3>
                        <div class="bg-yellow-50 p-4 rounded-lg">
                            <p><strong>Pagi:</strong> Bubur oatmeal dengan pisang + susu rendah lemak</p>
                            <p><strong>Siang:</strong> Nasi merah, ikan panggang, tumis bayam</p>
                            <p><strong>Sore:</strong> Buah pepaya atau apel</p>
                            <p><strong>Malam:</strong> Sup ayam dengan wortel dan kentang</p>
                        </div>
                    </div>
                `
            },
            tulang: {
                title: "Berjemur",
                subtitle: "Tata cara berjemur yang aman untuk penyintas stroke",
                icon: '<i class="fas fa-bone text-blue-500"></i>',
                content: `
                    <div class="space-y-6">
                        <h2 class="text-2xl font-bold text-gray-800">ğŸ“˜ Tata Cara Berjemur yang Aman untuk Penyintas Stroke</h2>
                        <p>Paparan sinar matahari dapat bermanfaat bagi penyintas stroke (mis. untuk sintesis <strong>vitamin D</strong>, meningkatkan mood, dan mendukung rehabilitasi fisik), tetapi harus dilakukan <strong>dengan aman dan terkontrol</strong>. Beberapa prinsip tata cara berjemur yang umum direkomendasikan dalam berbagai sumber kesehatan dan penelitian adalah sebagai berikut:</p>
                        
                        <h3 class="text-xl font-bold text-gray-800">1) Waktu Berjemur</h3>
                        <p>ğŸ“ <strong>Pagi hari (07.00â€“10.00)</strong> adalah waktu terbaik untuk berjemur karena intensitas sinar UV lebih rendah, sehingga risiko kulit terbakar lebih minimal.</p>
                        <p>â¡ï¸ Hindari berjemur saat sinar matahari sangat kuat (sekitar 10.00â€“15.00) karena risiko <em>sunburn</em> dan stres panas lebih tinggi.</p>
                        
                        <h3 class="text-xl font-bold text-gray-800">2) Durasi</h3>
                        <p>ğŸ•’ <strong>10â€“30 menit per hari</strong>, tergantung pada warna kulit, usia, dan kondisi kesehatan.</p>
                        <ul class="list-disc pl-6 space-y-1">
                            <li>Banyak sumber umum merekomendasikan <strong>10â€“15 menit</strong> untuk sebagian besar orang dengan paparan pagi.</li>
                            <li>Beberapa penelitian menunjukkan <strong>30 menit paparan harian selama beberapa minggu</strong> dapat memberikan efek positif pada suasana hati dan aktivitas pasca stroke.</li>
                            <li>Durasi optimal berbeda-beda (kulit lebih gelap atau kurang paparan sinar akan membutuhkan waktu lebih panjang).</li>
                        </ul>
                        
                        <h3 class="text-xl font-bold text-gray-800">3) Bagian Tubuh yang Dipaparkan</h3>
                        <p>ğŸ“Œ Biarkan <strong>kulit tangan, wajah, lengan, atau kaki</strong> terpapar sinar matahari langsung tanpa tabir surya <em>jika hanya dalam durasi pendek</em> (tanpa perlindungan).</p>
                        <p>â¡ï¸ Namun, jika berjemur lebih lama atau saat sinar UV kuat, pertimbangkan <strong>tabir surya</strong>, topi, atau pakaian pelindung untuk mengurangi risiko kulit rusak.</p>
                        
                        <h3 class="text-xl font-bold text-gray-800">4) Hidrasi dan Proteksi</h3>
                        <p>ğŸ’§ Pastikan tubuh cukup <strong>terhidrasi</strong> sebelum dan setelah berjemur karena risiko dehidrasi lebih tinggi pada pasien stroke, terutama yang memakai obat tekanan darah.</p>
                        <p>ğŸ‘• Gunakan pelindung seperti <strong>kacamata UV dan topi</strong> jika diperlukan untuk kenyamanan dan proteksi tambahan.</p>
                        
                        <h3 class="text-xl font-bold text-gray-800">5) Konsultasi Medis</h3>
                        <p>ğŸ“ Karena setiap pasien stroke berbeda, konsultasikan durasi dan jadwal berjemur <strong>dengan dokter atau tim rehabilitasi</strong>. Paparan sinar matahari tidak mengganti terapi medis utama.</p>
                        
                        <h3 class="text-xl font-bold text-gray-800">ğŸ“Œ Kesimpulan</h3>
                        <p>Berjemur dengan <strong>cara, waktu, dan durasi yang tepat</strong> dapat menjadi <em>intervensi pendukung</em> bagi penyintas stroke, terutama untuk <strong>mendukung produksi vitamin D dan kesehatan mental/aktivitas harian</strong>, namun <strong>tidak menggantikan terapi medis utama</strong>. Semua program paparan sinar matahari sebaiknya disesuaikan dengan kondisi klinis dan dikonsultasikan dengan tenaga profesional kesehatan dahulu.</p>
                    </div>
                `
            },
            otak: {
                title: "Fisioterapi",
                subtitle: "Panduan lengkap fisioterapi pasca stroke",
                icon: '<i class="fas fa-brain text-purple-500"></i>',
                content: `
                    <div class="space-y-6">
                        <h2 class="text-2xl font-bold text-gray-800">ğŸ§ Apa Itu Fisioterapi Pasca Stroke dan Mengapa Penting?</h2>
                        <p>Fisioterapi pasca stroke adalah serangkaian latihan dan perawatan yang dirancang untuk membantu pasien stroke memulihkan fungsi fisik, meningkatkan kekuatan otot, serta mengembalikan keseimbangan dan koordinasi tubuh. Stroke seringkali menyebabkan kelemahan pada satu sisi tubuh (hemiplegia), gangguan keseimbangan, dan kesulitan bergerak. Fisioterapi bertujuan untuk meminimalkan dampak tersebut, membantu pasien mencapai kemandirian, dan pada akhirnya meningkatkan kualitas hidup mereka.</p>
                        
                        <h2 class="text-2xl font-bold text-gray-800">ğŸ¥ Tahapan dan Pendekatan dalam Fisioterapi Stroke</h2>
                        <p>Proses fisioterapi biasanya mengikuti alur yang terstruktur untuk memastikan hasil yang optimal.</p>
                        
                        <h3 class="text-xl font-bold text-gray-800">1. Evaluasi Awal dan Penetapan Tujuan</h3>
                        <p>Langkah pertama adalah evaluasi komprehensif oleh fisioterapis untuk menilai kondisi pasien, meliputi kekuatan otot, rentang gerak sendi, keseimbangan, koordinasi, dan kemampuan fungsional dasar. Dari evaluasi ini, fisioterapis akan menetapkan tujuan pemulihan yang spesifik, realistis, dan terukur, yang disesuaikan dengan kebutuhan dan kemampuan unik setiap pasien.</p>
                        
                        <h3 class="text-xl font-bold text-gray-800">2. Kapan Harus Memulai?</h3>
                        <p><strong>Fisioterapi dapat dimulai sedini mungkin, bahkan 24-48 jam setelah pasien dinyatakan stabil secara medis</strong>. Mobilisasi dini ini penting untuk mencegah komplikasi seperti kekakuan sendi, luka tekan, dan pneumonia. Penelitian menunjukkan bahwa memulai terapi lebih awal dapat mempercepat proses pemulihan.</p>
                        
                        <h3 class="text-xl font-bold text-gray-800">3. Pendekatan Multidisiplin</h3>
                        <p>Pemulihan stroke yang efektif membutuhkan kerja sama tim. Fisioterapis biasanya bekerja sama dengan <strong>dokter spesialis rehabilitasi medik, terapis okupasi, terapis wicara, psikolog, dan perawat</strong> untuk memberikan perawatan yang holistik dan menyeluruh.</p>
                        
                        <h2 class="text-2xl font-bold text-gray-800">ğŸ‹ï¸ Jenis-Jenis Latihan Fisioterapi</h2>
                        <p>Berikut adalah tabel yang merangkum berbagai jenis latihan yang umum diberikan, lengkap dengan tujuan dan contohnya.</p>
                        
                        <table class="article-table">
                            <thead>
                                <tr>
                                    <th>Jenis Latihan</th>
                                    <th>Tujuan Utama</th>
                                    <th>Contoh Gerakan/Teknik</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr>
                                    <td><strong>Latihan Rentang Gerak</strong></td>
                                    <td>Mencegah kekakuan sendi, mempertahankan kelenturan otot dan ligamen.</td>
                                    <td>
                                        <ul class="list-disc pl-5">
                                            <li><strong>Pasif:</strong> Terapis menggerakkan tangan/kaki pasien yang lumpuh.</li>
                                            <li><strong>Aktif:</strong> Pasien menggerakkan sendiri anggota tubuhnya yang sehat atau yang sudah mulai pulih.</li>
                                        </ul>
                                    </td>
                                </tr>
                                <tr>
                                    <td><strong>Latihan Penguatan Otot</strong></td>
                                    <td>Meningkatkan kekuatan otot-otot yang melemah, terutama pada sisi tubuh yang terkena stroke.</td>
                                    <td>
                                        <ul class="list-disc pl-5">
                                            <li>Bangkit dari posisi duduk ke berdiri berulang kali.</li>
                                            <li>Mengangkat beban ringan atau menggunakan <strong>resistance band</strong>.</li>
                                        </ul>
                                    </td>
                                </tr>
                                <tr>
                                    <td><strong>Latihan Keseimbangan & Koordinasi</strong></td>
                                    <td>Meningkatkan stabilitas tubuh, mengontrol postur, dan mengurangi risiko jatuh.</td>
                                    <td>
                                        <ul class="list-disc pl-5">
                                            <li>Berdiri dengan satu kaki (dengan bantuan).</li>
                                            <li>Berjinjit sambil berpegangan.</li>
                                            <li>Menggunakan <strong>gym ball</strong> untuk melatih otot inti.</li>
                                        </ul>
                                    </td>
                                </tr>
                                <tr>
                                    <td><strong>Latihan Fungsional & Mobilitas</strong></td>
                                    <td>Melatih kemampuan melakukan aktivitas sehari-hari secara mandiri.</td>
                                    <td>
                                        <ul class="list-disc pl-5">
                                            <li>Latihan duduk, berdiri, dan <strong>berpindah tempat</strong> (dari tempat tidur ke kursi roda).</li>
                                            <li>Latihan <strong>berjalan</strong> (ambulasi) dengan alat bantu seperti <strong>parallel bar</strong> atau <em>walker</em>.</li>
                                            <li>Latihan mempraktikkan kegiatan sehari-hari seperti berpakaian atau makan.</li>
                                        </ul>
                                    </td>
                                </tr>
                                <tr>
                                    <td><strong>Teknik Khusus</strong></td>
                                    <td>Merangsang saraf dan otot, serta melatih pola gerakan tertentu.</td>
                                    <td>
                                        <ul class="list-disc pl-5">
                                            <li><strong>Constraint-Induced Movement Therapy (CIMT):</strong> Membatasi gerakan tangan yang sehat untuk memaksa penggunaan tangan yang lemah.</li>
                                            <li><strong>Stimulasi Listrik Fungsional (FES):</strong> Menggunakan aliran listrik ringan untuk merangsang otot yang lumpuh agar berkontraksi.</li>
                                            <li><strong>Motor Imagery:</strong> Membayangkan gerakan sebelum melakukannya untuk melatih koneksi otak-otot.</li>
                                            <li><strong>Diagonal Pattern Exercise:</strong> Latihan dengan gerakan diagonal yang terbukti efektif meningkatkan kontrol otot batang tubuh (torso) dan kemampuan berjalan.</li>
                                        </ul>
                                    </td>
                                </tr>
                            </tbody>
                        </table>
                        
                        <h2 class="text-2xl font-bold text-gray-800">ğŸ¡ Peran Keluarga dan Program di Rumah</h2>
                        <p>Dukungan keluarga adalah pilar penting dalam keberhasilan fisioterapi. <strong>Pemulihan tidak hanya terjadi di klinik, tetapi juga di rumah</strong>.</p>
                        <ul class="list-disc pl-6 space-y-2">
                            <li><strong>Pendampingan saat Latihan:</strong> Keluarga dapat mendampingi pasien saat melakukan latihan di rumah. Pastikan untuk selalu mengawasi agar pasien tidak terjatuh dan memastikan gerakan dilakukan dengan benar.</li>
                            <li><strong>Cara Membantu Pasien Berjalan:</strong> Jika pasien membutuhkan bantuan saat berjalan, pelajari cara menopang yang benar, misalnya dengan meletakkan tangan penopang di bawah ketiak pasien atau menggunakan sabuk bantu.</li>
                            <li><strong>Program Latihan di Rumah:</strong> Fisioterapis akan memberikan program latihan mandiri yang terstruktur untuk dilakukan di rumah. Konsistensi dalam menjalankan program ini sangat penting untuk melihat hasil jangka panjang.</li>
                            <li><strong>Menciptakan Lingkungan yang Aman:</strong> Pastikan rumah aman untuk mobilitas pasien, misalnya dengan menyingkirkan karpet yang mudah membuat tergelincir, memasang pegangan di kamar mandi, dan memastikan ruangan memiliki pencahayaan yang baik.</li>
                        </ul>
                        
                        <h2 class="text-2xl font-bold text-gray-800">â“ Informasi Tambahan yang Perlu Diketahui</h2>
                        <ul class="list-disc pl-6 space-y-2">
                            <li><strong>Berapa Lama Terapi Dilakukan?</strong> Durasi fisioterapi bervariasi, tergantung pada tingkat keparahan stroke dan respons pasien terhadap terapi. Beberapa pasien mungkin memerlukan terapi rutin selama beberapa bulan hingga satu tahun.</li>
                            <li><strong>Apakah Bisa Sembuh Total?</strong> Fisioterapi tidak "menyembuhkan" stroke, tetapi <strong>sangat efektif untuk "memulihkan" fungsi tubuh</strong>. Tujuannya adalah membantu pasien mencapai tingkat kemandirian setinggi mungkin dan kembali beraktivitas.</li>
                            <li><strong>Terapi di Rumah vs. di Klinik:</strong> Penelitian besar menunjukkan bahwa program latihan di rumah yang terstruktur dan diawasi fisioterapis bisa sama efektifnya dengan terapi menggunakan alat canggih di pusat rehabilitasi, seperti <em>body-weight supported treadmill</em>. Ini kabar baik karena terapi di rumah seringkali lebih mudah dijalani dan lebih nyaman bagi pasien.</li>
                            <li><strong>Mengatasi Tantangan Lain:</strong>
                                <ul class="list-disc pl-6 mt-1">
                                    <li><strong>Spastisitas (Kekakuan Otot):</strong> Jika otot terasa kaku, terapis mungkin merekomendasikan latihan peregangan rutin, penggunaan bidai (splint) di malam hari, atau terapi panas/dingin. Dalam beberapa kasus, dokter mungkin meresepkan obat untuk mengurangi kekakuan.</li>
                                    <li><strong>Gangguan Lapang Pandang (Hemianopia):</strong> Jika pasien mengalami kesulitan melihat objek di satu sisi, mereka bisa diajarkan untuk <strong>menolehkan kepala ke sisi yang lumpuh</strong> saat melihat sekeliling.</li>
                                </ul>
                            </li>
                        </ul>
                    </div>
                `
            }
        };

        // --- KONFIGURASI ---
        const DB_DISCUSSIONS = 'sehat_lansia_discussions';
        let currentSort = 'newest';
        let replyingToId = null;
        let currentArticle = null;

        // --- INIT SAAT LOAD ---
        document.addEventListener('DOMContentLoaded', () => {
            console.log('SehatLansia - Aplikasi siap digunakan!');
            loadDiscussions();
            setupScrollAnimation();
            updateStats();
            
            // Cek apakah localStorage tersedia
            if (typeof(Storage) === "undefined") {
                alert("Browser Anda tidak mendukung localStorage. Beberapa fitur mungkin tidak berfungsi.");
            }
            
            // Sembunyikan pesan "belum ada diskusi" sementara
            document.getElementById('noDiscussions').classList.add('hidden');
        });

        // --- SETUP SCROLL ANIMATION ---
        function setupScrollAnimation() {
            const fadeSections = document.querySelectorAll('.fade-in-section');
            
            const observer = new IntersectionObserver((entries) => {
                entries.forEach(entry => {
                    if (entry.isIntersecting) {
                        entry.target.classList.add('is-visible');
                    }
                });
            }, {
                threshold: 0.1,
                rootMargin: '0px 0px -50px 0px'
            });
            
            fadeSections.forEach(section => {
                observer.observe(section);
            });
        }

        // --- FUNGSI TAMPILKAN ARTIKEL ---
        function showArticle(type) {
            const article = articlesDB[type];
            if (!article) return;
            
            currentArticle = type;
            document.getElementById('articleIcon').innerHTML = article.icon;
            document.getElementById('articleTitle').textContent = article.title;
            document.getElementById('articleSubtitle').textContent = article.subtitle;
            document.getElementById('articleContent').innerHTML = article.content;
            
            openModal('articleModal');
        }

        // --- FUNGSI DISKUSI ---
        function loadDiscussions() {
            try {
                let discussions = JSON.parse(localStorage.getItem(DB_DISCUSSIONS)) || [];
                
                // Jika belum ada diskusi, buat beberapa contoh
                if (discussions.length === 0) {
                    discussions = [
                        {
                            id: generateId(),
                            topic: "Tips Menurunkan Tekanan Darah",
                            content: "Saya punya tekanan darah 150/95, apa yang bisa saya lakukan selain minum obat?",
                            user: "Budi Santoso",
                            timestamp: new Date(Date.now() - 86400000).toISOString(),
                            replies: [
                                {
                                    id: generateId(),
                                    content: "Coba kurangi garam dan lakukan jalan pagi 30 menit setiap hari. Ibu saya juga hipertensi dan cara itu membantu.",
                                    user: "Siti Rahayu",
                                    timestamp: new Date(Date.now() - 43200000).toISOString(),
                                    likes: 3
                                },
                                {
                                    id: generateId(),
                                    content: "Saran saya, konsultasi rutin ke dokter dan minum obat teratur. Jangan lupa cek tekanan darah mingguan.",
                                    user: "dr. Hartono",
                                    timestamp: new Date(Date.now() - 21600000).toISOString(),
                                    likes: 5,
                                    isDoctor: true
                                }
                            ],
                            likes: 8,
                            views: 42,
                            userLiked: false
                        },
                        {
                            id: generateId(),
                            topic: "Nyeri Sendi Lutut",
                            content: "Lutut saya sering nyeri saat bangun tidur atau setelah duduk lama. Ada saran olahraga yang aman?",
                            user: "Mbak Sari",
                            timestamp: new Date(Date.now() - 172800000).toISOString(),
                            replies: [
                                {
                                    id: generateId(),
                                    content: "Coba senam ringan di kursi atau berenang. Saya juga pakai kompres hangat sebelum tidur.",
                                    user: "Pak Darso",
                                    timestamp: new Date(Date.now() - 86400000).toISOString(),
                                    likes: 4
                                }
                            ],
                            likes: 5,
                            views: 28,
                            userLiked: false
                        }
                    ];
                    localStorage.setItem(DB_DISCUSSIONS, JSON.stringify(discussions));
                }
                
                // Load liked status dari localStorage
                discussions.forEach(discussion => {
                    const likeKey = `like_${discussion.id}`;
                    discussion.userLiked = localStorage.getItem(likeKey) === 'true';
                });
                
                sortAndRenderDiscussions(discussions);
            } catch (error) {
                console.error('Error loading discussions:', error);
                document.getElementById('discussionsList').innerHTML = `
                    <div class="bg-red-50 p-4 rounded-lg border border-red-200">
                        <p class="text-red-700">Terjadi kesalahan saat memuat diskusi. Silakan refresh halaman.</p>
                    </div>
                `;
            }
        }

        function sortAndRenderDiscussions(discussions) {
            let sorted = [...discussions];
            
            if (currentSort === 'newest') {
                sorted.sort((a, b) => new Date(b.timestamp) - new Date(a.timestamp));
                document.getElementById('sortNewest').classList.add('bg-blue-100', 'text-blue-700');
                document.getElementById('sortNewest').classList.remove('bg-gray-100', 'text-gray-700');
                document.getElementById('sortPopular').classList.add('bg-gray-100', 'text-gray-700');
                document.getElementById('sortPopular').classList.remove('bg-blue-100', 'text-blue-700');
            } else {
                sorted.sort((a, b) => {
                    const aPopularity = (a.likes || 0) + (a.replies?.length || 0);
                    const bPopularity = (b.likes || 0) + (b.replies?.length || 0);
                    return bPopularity - aPopularity;
                });
                document.getElementById('sortPopular').classList.add('bg-blue-100', 'text-blue-700');
                document.getElementById('sortPopular').classList.remove('bg-gray-100', 'text-gray-700');
                document.getElementById('sortNewest').classList.add('bg-gray-100', 'text-gray-700');
                document.getElementById('sortNewest').classList.remove('bg-blue-100', 'text-blue-700');
            }
            
            renderDiscussions(sorted);
        }

        function sortDiscussions(type) {
            currentSort = type;
            const discussions = JSON.parse(localStorage.getItem(DB_DISCUSSIONS)) || [];
            sortAndRenderDiscussions(discussions);
        }

        function renderDiscussions(discussions) {
            const list = document.getElementById('discussionsList');
            const noDiscussions = document.getElementById('noDiscussions');
            
            if (discussions.length === 0) {
                list.innerHTML = '';
                noDiscussions.classList.remove('hidden');
                return;
            }
            
            noDiscussions.classList.add('hidden');
            list.innerHTML = '';
            
            discussions.forEach(discussion => {
                const timeAgo = getTimeAgo(discussion.timestamp);
                const repliesCount = discussion.replies ? discussion.replies.length : 0;
                
                list.innerHTML += `
                    <div class="bg-white rounded-xl shadow-md border border-gray-100 overflow-hidden hover:shadow-lg transition-shadow duration-300" id="discussion-${discussion.id}">
                        <div class="p-6">
                            <div class="flex justify-between items-start mb-3">
                                <div class="flex items-center">
                                    <div class="w-10 h-10 ${discussion.user === 'dr. Hartono' ? 'bg-green-100' : 'bg-blue-100'} rounded-full flex items-center justify-center mr-3">
                                        <i class="fas fa-user ${discussion.user === 'dr. Hartono' ? 'text-green-600' : 'text-blue-600'}"></i>
                                    </div>
                                    <div>
                                        <h4 class="font-bold text-gray-800">${discussion.user}</h4>
                                        <p class="text-sm text-gray-500">${timeAgo}</p>
                                    </div>
                                </div>
                                <span class="bg-blue-100 text-blue-700 text-xs font-bold px-3 py-1 rounded-full">
                                    ${repliesCount} Balasan
                                </span>
                            </div>
                            
                            <h3 class="text-xl font-bold text-gray-800 mb-3">${discussion.topic}</h3>
                            <p class="text-gray-700 mb-4">${discussion.content}</p>
                            
                            <div class="flex justify-between items-center">
                                <div class="flex gap-4">
                                    <button onclick="likeDiscussion('${discussion.id}')" class="flex items-center gap-1 ${discussion.userLiked ? 'text-red-600' : 'text-gray-600'} hover:text-red-600">
                                        <i class="fas fa-heart ${discussion.userLiked ? 'text-red-600' : ''}"></i>
                                        <span>${discussion.likes || 0}</span>
                                    </button>
                                    <button onclick="openReplyModal('${discussion.id}', '${discussion.topic}')" class="flex items-center gap-1 text-gray-600 hover:text-blue-600">
                                        <i class="fas fa-reply"></i>
                                        <span>Balas</span>
                                    </button>
                                    <span class="flex items-center gap-1 text-gray-600">
                                        <i class="fas fa-eye"></i>
                                        <span>${discussion.views || 0}</span>
                                    </span>
                                </div>
                                <button onclick="toggleReplies('${discussion.id}')" class="text-blue-600 hover:text-blue-800 font-medium">
                                    Lihat Balasan <i class="fas fa-chevron-down ml-1"></i>
                                </button>
                            </div>
                            
                            <!-- Replies Container -->
                            <div id="replies-${discussion.id}" class="mt-6 hidden space-y-4">
                                ${discussion.replies && discussion.replies.length > 0 ? 
                                    discussion.replies.map(reply => {
                                        const replyTime = getTimeAgo(reply.timestamp);
                                        const isDoctor = reply.isDoctor ? '<span class="text-xs bg-green-600 text-white px-2 py-0.5 rounded ml-2">Dokter</span>' : '';
                                        return `
                                            <div class="reply-item p-4 rounded-lg">
                                                <div class="flex justify-between items-start mb-2">
                                                    <div class="flex items-center">
                                                        <div class="w-8 h-8 ${reply.isDoctor ? 'bg-green-100' : 'bg-gray-100'} rounded-full flex items-center justify-center mr-2">
                                                            <i class="fas fa-user ${reply.isDoctor ? 'text-green-600' : 'text-gray-600'} text-sm"></i>
                                                        </div>
                                                        <h5 class="font-bold text-gray-700 flex items-center">${reply.user} ${isDoctor}</h5>
                                                    </div>
                                                    <span class="text-xs text-gray-400">${replyTime}</span>
                                                </div>
                                                <p class="text-gray-600">${reply.content}</p>
                                                ${reply.likes > 0 ? `
                                                    <div class="mt-2 text-xs text-gray-500">
                                                        <i class="fas fa-heart text-red-500"></i> ${reply.likes} orang menyukai ini
                                                    </div>
                                                ` : ''}
                                            </div>
                                        `;
                                    }).join('') 
                                : '<p class="text-gray-500 text-center py-4">Belum ada balasan. Jadilah yang pertama membalas!</p>'}
                            </div>
                        </div>
                    </div>
                `;
            });
            
            updateStats();
        }

        function addDiscussion() {
            const userName = document.getElementById('userName').value.trim();
            const topic = document.getElementById('discussionTopic').value.trim();
            const content = document.getElementById('commentInput').value.trim();
            
            if (!topic) {
                alert('Mohon isi judul diskusi.');
                document.getElementById('discussionTopic').focus();
                return;
            }
            
            if (!content) {
                alert('Mohon isi isi diskusi.');
                document.getElementById('commentInput').focus();
                return;
            }
            
            try {
                let discussions = JSON.parse(localStorage.getItem(DB_DISCUSSIONS)) || [];
                const newDiscussion = {
                    id: generateId(),
                    topic: topic,
                    content: content,
                    user: userName || "Tamu",
                    timestamp: new Date().toISOString(),
                    replies: [],
                    likes: 0,
                    views: 0,
                    userLiked: false
                };
                
                discussions.unshift(newDiscussion);
                localStorage.setItem(DB_DISCUSSIONS, JSON.stringify(discussions));
                
                // Reset form
                document.getElementById('userName').value = '';
                document.getElementById('discussionTopic').value = '';
                document.getElementById('commentInput').value = '';
                
                // Reload dan scroll ke diskusi baru
                loadDiscussions();
                setTimeout(() => {
                    const element = document.getElementById(`discussion-${newDiscussion.id}`);
                    if (element) {
                        element.scrollIntoView({ behavior: 'smooth' });
                        element.classList.add('highlight-new');
                        
                        // Hapus highlight setelah 2 detik
                        setTimeout(() => {
                            element.classList.remove('highlight-new');
                        }, 2000);
                    }
                }, 100);
                
                alert('Diskusi berhasil ditambahkan!');
            } catch (error) {
                console.error('Error adding discussion:', error);
                alert('Terjadi kesalahan saat menyimpan diskusi.');
            }
        }

        function openReplyModal(discussionId, topic) {
            replyingToId = discussionId;
            document.getElementById('replyTitle').textContent = 'Balas Diskusi';
            document.getElementById('replyToQuestion').textContent = `Membalas: "${topic}"`;
            document.getElementById('replyUserName').value = '';
            document.getElementById('replyInput').value = '';
            openModal('replyModal');
        }

        function submitReply() {
            const userName = document.getElementById('replyUserName').value.trim();
            const content = document.getElementById('replyInput').value.trim();
            
            if (!content) {
                alert('Mohon isi balasan Anda.');
                document.getElementById('replyInput').focus();
                return;
            }
            
            try {
                let discussions = JSON.parse(localStorage.getItem(DB_DISCUSSIONS)) || [];
                const discussionIndex = discussions.findIndex(d => d.id === replyingToId);
                
                if (discussionIndex === -1) {
                    alert('Diskusi tidak ditemukan.');
                    return;
                }
                
                if (!discussions[discussionIndex].replies) {
                    discussions[discussionIndex].replies = [];
                }
                
                const newReply = {
                    id: generateId(),
                    content: content,
                    user: userName || "Tamu",
                    timestamp: new Date().toISOString(),
                    likes: 0
                };
                
                discussions[discussionIndex].replies.push(newReply);
                localStorage.setItem(DB_DISCUSSIONS, JSON.stringify(discussions));
                
                closeModal('replyModal');
                
                // Update tampilan langsung
                const repliesContainer = document.getElementById(`replies-${replyingToId}`);
                if (repliesContainer) {
                    repliesContainer.classList.remove('hidden');
                    const replyTime = getTimeAgo(newReply.timestamp);
                    const replyHtml = `
                        <div class="reply-item p-4 rounded-lg highlight-new">
                            <div class="flex justify-between items-start mb-2">
                                <div class="flex items-center">
                                    <div class="w-8 h-8 bg-gray-100 rounded-full flex items-center justify-center mr-2">
                                        <i class="fas fa-user text-gray-600 text-sm"></i>
                                    </div>
                                    <h5 class="font-bold text-gray-700">${newReply.user}</h5>
                                </div>
                                <span class="text-xs text-gray-400">${replyTime}</span>
                            </div>
                            <p class="text-gray-600">${newReply.content}</p>
                        </div>
                    `;
                    repliesContainer.innerHTML += replyHtml;
                    
                    // Update jumlah balasan
                    const badge = document.querySelector(`#discussion-${replyingToId} .bg-blue-100 span`);
                    if (badge) {
                        const currentCount = parseInt(badge.textContent) || 0;
                        badge.textContent = currentCount + 1;
                    }
                    
                    // Update tombol toggle
                    const toggleButton = document.querySelector(`#discussion-${replyingToId} button[onclick="toggleReplies('${replyingToId}')"]`);
                    if (toggleButton) {
                        toggleButton.innerHTML = 'Sembunyikan Balasan <i class="fas fa-chevron-up ml-1"></i>';
                    }
                    
                    // Hapus highlight setelah 2 detik
                    setTimeout(() => {
                        const newReplyElement = repliesContainer.lastElementChild;
                        if (newReplyElement) newReplyElement.classList.remove('highlight-new');
                    }, 2000);
                }
                
                updateStats();
                alert('Balasan berhasil dikirim!');
            } catch (error) {
                console.error('Error submitting reply:', error);
                alert('Terjadi kesalahan saat mengirim balasan.');
            }
        }

        function likeDiscussion(discussionId) {
            try {
                let discussions = JSON.parse(localStorage.getItem(DB_DISCUSSIONS)) || [];
                const discussionIndex = discussions.findIndex(d => d.id === discussionId);
                
                if (discussionIndex === -1) return;
                
                // Cek apakah sudah ada like dari user ini (berdasarkan localStorage)
                const likeKey = `like_${discussionId}`;
                const hasLiked = localStorage.getItem(likeKey) === 'true';
                
                if (hasLiked) {
                    discussions[discussionIndex].likes = Math.max(0, (discussions[discussionIndex].likes || 0) - 1);
                    localStorage.setItem(likeKey, 'false');
                    discussions[discussionIndex].userLiked = false;
                } else {
                    discussions[discussionIndex].likes = (discussions[discussionIndex].likes || 0) + 1;
                    localStorage.setItem(likeKey, 'true');
                    discussions[discussionIndex].userLiked = true;
                }
                
                localStorage.setItem(DB_DISCUSSIONS, JSON.stringify(discussions));
                
                // Update tampilan like
                const likeButton = document.querySelector(`#discussion-${discussionId} .fa-heart`);
                const likeCount = document.querySelector(`#discussion-${discussionId} .fa-heart + span`);
                
                if (likeButton && likeCount) {
                    if (discussions[discussionIndex].userLiked) {
                        likeButton.classList.add('text-red-600');
                        likeButton.parentElement.classList.add('text-red-600');
                    } else {
                        likeButton.classList.remove('text-red-600');
                        likeButton.parentElement.classList.remove('text-red-600');
                    }
                    likeCount.textContent = discussions[discussionIndex].likes;
                }
            } catch (error) {
                console.error('Error liking discussion:', error);
            }
        }

        function toggleReplies(discussionId) {
            const repliesContainer = document.getElementById(`replies-${discussionId}`);
            const toggleButton = document.querySelector(`#discussion-${discussionId} button[onclick="toggleReplies('${discussionId}')"]`);
            
            if (repliesContainer.classList.contains('hidden')) {
                repliesContainer.classList.remove('hidden');
                toggleButton.innerHTML = 'Sembunyikan Balasan <i class="fas fa-chevron-up ml-1"></i>';
                
                // Update view count
                try {
                    let discussions = JSON.parse(localStorage.getItem(DB_DISCUSSIONS)) || [];
                    const discussionIndex = discussions.findIndex(d => d.id === discussionId);
                    if (discussionIndex !== -1) {
                        discussions[discussionIndex].views = (discussions[discussionIndex].views || 0) + 1;
                        localStorage.setItem(DB_DISCUSSIONS, JSON.stringify(discussions));
                        
                        // Update view count display
                        const viewCount = document.querySelector(`#discussion-${discussionId} .fa-eye + span`);
                        if (viewCount) {
                            viewCount.textContent = discussions[discussionIndex].views;
                        }
                    }
                } catch (error) {
                    console.error('Error updating view count:', error);
                }
            } else {
                repliesContainer.classList.add('hidden');
                toggleButton.innerHTML = 'Lihat Balasan <i class="fas fa-chevron-down ml-1"></i>';
            }
        }

        function updateStats() {
            try {
                const discussions = JSON.parse(localStorage.getItem(DB_DISCUSSIONS)) || [];
                const totalDiscussions = discussions.length;
                const totalReplies = discussions.reduce((sum, d) => sum + (d.replies ? d.replies.length : 0), 0);
                
                document.getElementById('totalDiscussions').textContent = totalDiscussions;
                document.getElementById('totalReplies').textContent = totalReplies;
            } catch (error) {
                console.error('Error updating stats:', error);
            }
        }

        // --- FUNGSI SEARCH ---
        function handleSearch() {
            const query = document.getElementById('searchInput').value.toLowerCase();
            const resultArea = document.getElementById('searchResultArea');
            const list = document.getElementById('articlesList');
            
            if(!query) { 
                resultArea.classList.add('hidden'); 
                return; 
            }

            const results = Object.keys(articlesDB)
                .filter(key => {
                    const article = articlesDB[key];
                    return article.title.toLowerCase().includes(query) || 
                           article.subtitle.toLowerCase().includes(query) ||
                           article.content.toLowerCase().includes(query);
                })
                .map(key => articlesDB[key]);
            
            list.innerHTML = "";
            if(results.length > 0) {
                results.forEach(res => {
                    list.innerHTML += `
                        <div class="bg-blue-50 p-4 rounded-lg border-l-4 border-blue-500 cursor-pointer hover:bg-blue-100" onclick="showArticle('${Object.keys(articlesDB).find(key => articlesDB[key] === res)}')">
                            <h5 class="font-bold text-blue-900">${res.title}</h5>
                            <p class="text-sm text-gray-700">${res.subtitle}</p>
                            <p class="text-xs text-blue-600 mt-2">Klik untuk baca lengkap â†’</p>
                        </div>
                    `;
                });
            } else {
                list.innerHTML = `<p class="text-red-500 italic">Artikel tidak ditemukan.</p>`;
            }
            resultArea.classList.remove('hidden');
        }

        // --- UTILS ---
        function openModal(id) { 
            document.getElementById(id).classList.remove('hidden');
            document.body.style.overflow = 'hidden';
        }
        
        function closeModal(id) { 
            document.getElementById(id).classList.add('hidden');
            document.body.style.overflow = 'auto';
        }
        
        function generateId() {
            return Date.now().toString(36) + Math.random().toString(36).substr(2, 5);
        }
        
        function getTimeAgo(timestamp) {
            try {
                const now = new Date();
                const past = new Date(timestamp);
                const diffMs = now - past;
                const diffMins = Math.floor(diffMs / 60000);
                const diffHours = Math.floor(diffMs / 3600000);
                const diffDays = Math.floor(diffMs / 86400000);
                
                if (diffMins < 60) return `${diffMins} menit lalu`;
                if (diffHours < 24) return `${diffHours} jam lalu`;
                if (diffDays < 7) return `${diffDays} hari lalu`;
                return past.toLocaleDateString('id-ID', { day: 'numeric', month: 'short' });
            } catch (error) {
                return 'beberapa waktu lalu';
            }
        }
        
        function toggleMobileMenu() {
            const menu = document.getElementById('mobileMenu');
            menu.classList.toggle('hidden');
        }
        
        // Fungsi share sederhana
        function shareOnFacebook() {
            const url = window.location.href;
            const text = "Lihat aplikasi SehatLansia - Panduan kesehatan untuk lansia!";
            window.open(`https://www.facebook.com/sharer/sharer.php?u=${encodeURIComponent(url)}&quote=${encodeURIComponent(text)}`, '_blank');
        }
        
        function shareOnWhatsApp() {
            const text = "Lihat aplikasi SehatLansia - Panduan kesehatan untuk lansia! " + window.location.href;
            window.open(`https://wa.me/?text=${encodeURIComponent(text)}`, '_blank');
        }
        
        function shareOnInstagram() {
            alert("Untuk berbagi di Instagram, salin link ini dan bagikan di Instagram Anda: " + window.location.href);
        }
        
        function shareArticleOnFacebook() {
            if (!currentArticle) return;
            const article = articlesDB[currentArticle];
            const text = `Baca artikel: "${article.title}" - ${article.subtitle}`;
            window.open(`https://www.facebook.com/sharer/sharer.php?quote=${encodeURIComponent(text)}`, '_blank');
        }
        
        function shareArticleOnWhatsApp() {
            if (!currentArticle) return;
            const article = articlesDB[currentArticle];
            const text = `Baca artikel: "${article.title}" - ${article.subtitle}`;
            window.open(`https://wa.me/?text=${encodeURIComponent(text)}`, '_blank');
        }
        
        function shareArticleOnInstagram() {
            if (!currentArticle) return;
            const article = articlesDB[currentArticle];
            alert(`Untuk berbagi artikel "${article.title}" di Instagram, salin teks berikut:\n\n${article.title}\n${article.subtitle}`);
        }
        
        // Tutup modal dengan ESC
        document.addEventListener('keydown', function(event) {
            if (event.key === 'Escape') {
                closeModal('articleModal');
                closeModal('replyModal');
            }
        });
    </script>
</body>
</html>
